(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5abf6778"],{7947:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-collect"},[s("van-nav-bar",{attrs:{title:"我的收藏","left-arrow":""},on:{"click-left":t.back}}),s("div",{staticClass:"collect-content"},[t.collects.length?t._e():s("div",{staticClass:"nothing"},[s("span",{staticClass:"null"},[t._v("nothing!")]),s("span",{staticClass:"go"},[t._v("快去"),s("span",[t._v(t._s(t.currentUser?"":" 登录 "))]),t._v("添加收藏吧^_^")])]),t._l(t.collects,(function(e,a){return s("div",{key:a,staticClass:"item"},[s("div",{staticClass:"img",on:{click:function(s){return t.movie_detail(e.id)}}},[s("img",{staticClass:"auto-img",attrs:{src:e.images.medium}})]),s("div",{staticClass:"content"},[s("p",{staticClass:"name ellipse"},[t._v(t._s(e.title))]),s("p",{staticClass:"director ellipse"},[s("span",[t._v("主演:")]),t._v(" "+t._s(e.main_performers)+" ")]),s("p",{staticClass:"desc lineClamp"},[s("span",[t._v("简介:")]),t._v(" "+t._s(e.summary)+" ")])]),s("span",{staticClass:"cancle",on:{click:function(s){return t.cancle(e.id)}}},[t._v("取消收藏")])])}))],2)],1)},c=[],r=(s("a434"),s("b0c0"),s("2f62")),n=Object(r["a"])("myCollectModule"),l=(n.mapState,n.mapMutations,{name:"my-collect",data:function(){return{currentUser:"",collects:[],nothing:1}},created:function(){var t=this;if(this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.currentUser){this.collects=[],this.$toast.loading({duration:0,message:"加载中···"});setTimeout((function(){for(var e=JSON.parse(localStorage.getItem("usersMessage")),s=0;s<e.length;s++)if(e[s].username==t.currentUser){var a=function(){for(var a=e[s].loveOrCollect,c=function(e){a[e].collect.iscollect&&t.axios({method:"GET",url:"https://douban.uieee.com/v2/movie/subject/"+a[e].id}).then((function(s){s.data.main_performers="";for(var c=0;c<s.data.casts.length;c++)s.data.main_performers+=s.data.casts[c].name+"/";s.data.main_performers=s.data.main_performers.substr(0,s.data.main_performers.length-1),t.collects.push(s.data),e==a.length-1&&t.$toast.clear()}))},r=0;r<a.length;r++)c(r);return"break"}();if("break"===a)break}!t.collects.length&&t.$toast.clear()}),2e3*Math.random())}},computed:{},methods:{back:function(){this.$router.go(-1)},movie_detail:function(t){this.$router.push({name:"movie_detail",query:t})},cancle:function(t){var e=this;this.$dialog.confirm({message:"确认取消收藏?"}).then((function(s){for(var a=0;a<e.collects.length;a++)if(e.collects[a].id==t){e.collects.splice(a,1);break}for(var c=JSON.parse(localStorage.getItem("usersMessage")),r=0;r<c.length;r++)if(c[r].username=e.currentUser){for(var n=c[r].loveOrCollect,l=0;l<n.length;l++)if(n[l].id==t){n[l].collect.iscollect=!1,0==n[l].collect.iscollect&&0==n[l].love.islove&&n.splice(l,1),localStorage.setItem("usersMessage",JSON.stringify(c));break}break}})).catch((function(t){}))}}}),i=l,o=(s("b1eb"),s("2877")),u=Object(o["a"])(i,a,c,!1,null,"642e7572",null);e["default"]=u.exports},b1eb:function(t,e,s){"use strict";var a=s("cd43"),c=s.n(a);c.a},cd43:function(t,e,s){}}]);
//# sourceMappingURL=chunk-5abf6778.c8ffbcdf.js.map